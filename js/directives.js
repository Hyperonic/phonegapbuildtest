angular.module("directory.directives",["ionic"]).directive("scrollDetector",["$window","$ionicScrollDelegate",function(e,t){return{restrict:"A",link:function(e,n,o){var i=n[0].querySelector(".scroll");n.on("scroll",function(){t.getScrollView(i)})}}}]).directive("nativeTransition",["$ionicGesture","$ionicPlatform",function(e,t){return{restrict:"A",link:function(n,o,i){e.on("tap",function(e){if(ionic.Platform.isWebView()){var n=i.direction||"left",o=i.transitiontype||"slide";t.ready(function(){switch(o){case"slide":window.plugins.nativepagetransitions.slide({direction:n},function(e){},function(e){alert("error: "+e)});break;case"flip":window.plugins.nativepagetransitions.flip({direction:n},function(e){},function(e){alert("error: "+e)});break;case"fade":window.plugins.nativepagetransitions.fade({},function(e){},function(e){alert("error: "+e)});break;default:window.plugins.nativepagetransitions.slide({direction:n},function(e){},function(e){alert("error: "+e)})}})}},o)}}}]).directive("onValidSubmit",["$parse","$timeout",function(e,t){return{require:"^form",restrict:"A",link:function(t,n,o,i){i.$submitted=!1;var r=e(o.onValidSubmit);n.on("submit",function(e){t.$apply(function(){n.addClass("ng-submitted"),i.$submitted=!0,i.$valid&&"function"==typeof r&&r(t,{$event:e})})}),t.$on("$destroy",function(){n.off("submit")})}}}]).directive("nksOnlyNumber",function(){return{restrict:"EA",require:"ngModel",link:function(e,t,n,o){e.$watch(n.ngModel,function(e,t){var i=String(e).split("");if("false"==n.allowNegative&&"-"==i[0]&&(e=e.toString().replace("-",""),o.$setViewValue(e),o.$render()),"false"==n.allowDecimal&&(e=parseInt(e),o.$setViewValue(e),o.$render()),"false"!=n.allowDecimal&&n.decimalUpto){var r=String(e).split(".");if(r[1]){var a=r[1].slice(0,n.decimalUpto);e=[r[0],a].join("."),o.$setViewValue(e),o.$render()}}0!==i.length&&(1!==i.length||"-"!=i[0]&&"."!==i[0])&&(2!==i.length||"-."!==e)&&isNaN(e)&&void 0!=e&&(o.$setViewValue(t),o.$render())})}}}).directive("validated",["$parse",function(e){return{restrict:"AEC",require:"^form",link:function(e,t,n,o){for(var i=t.find("*"),r=0;r<i.length;r++)!function(n){var i=n.attributes;if(void 0!=i.getNamedItem("ng-model")&&void 0!=i.getNamedItem("name")){var r=o[i.name.value];void 0!=r&&e.$watch(function(){return o.$submitted+"_"+r.$valid},function(){if(1==o.$submitted){var e=angular.element(n);e.hasClass("ng-invalid")?(t.removeClass("has-success"),t.addClass("has-error")):t.removeClass("has-error").addClass("has-success")}})}}(i[r])}}}]).directive("placeholdfix",function(){return{restrict:"A",link:function(e,t,n){ionic.Platform.isAndroid()&&(t[0].type="text",t.bind("blur",function(e){e.target.type="text"}),t.bind("focus",function(e){e.target.type="number"}),e.$on("$destroy",function(){t.unbind()}))}}}).directive("map",["$ionicPlatform","EmployeeService","baseUrl","$timeout","$interval","$rootScope","Initializer",function(e,t,n,o,i,r,a){var l,s,c,d;return c=document.createElement("div"),c.id="googleMapWrapper",document.body.appendChild(c),s=0,l={},{restrict:"EA",scope:{onCreate:"&",latlon:"=",circles:"=?",markers:"=",mapCentered:"=",centermap:"=",gmap:"=?",mapopt:"=?"},link:function(i,a,u){var m,p,f,g,v,h,w,y,b,k,x,C,M={},D={},T={},S={},I=function(e){for(var t in D)D[t].close()},E=function(){var e=r.map.getCenter();google.maps.event.trigger(r.map,"resize"),r.map.setCenter(e)},A=function(){if(!r.map){if(w=i.latlon&&(i.latlon.lat||i.latlon.pickup_lat)||r.lat,y=i.latlon&&(i.latlon.lon||i.latlon.pickup_lon)||r.lon,d={center:new google.maps.LatLng(w,y),zoom:14,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_CENTER},mapTypeControl:!1,panControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,maxZoom:17,minZoom:6},0===c.children.length?(s++,m=document.createElement("div"),m.dataset.mapId=s,m.style.width="100%",m.style.height="100%",m.classList.add("map"),c.appendChild(m),r.map=l[s]=new google.maps.Map(m,d),google.maps.event.addListener(r.map,"dragend",function(){r.mapCentered=!1}),google.maps.event.addListener(r.map,"click",I)):(m=c.children[0],r.map=l[m.dataset.mapId],r.map.setOptions(d)),i.gmap&&(i.gmap.map=p,r.$broadcast("gmaps:loaded")),r.mapid="quotemap",r.setMapClass(r.mapclass),a[0].appendChild(m),E(),r.smallScreen=window.innerHeight<700,google.maps.event.addDomListener(window,"resize",function(){r.smallScreen=window.innerHeight<700,E()}),P&&r.setMapClass(P),a[0].addEventListener("DOMNodeRemovedFromDocument",function(){c.appendChild(a[0].children[0])}),x=new google.maps.DirectionsService,C=new google.maps.DirectionsRenderer({suppressMarkers:!0,preserveViewport:!0}),angular.isDefined(u.showDirections)){var e=new google.maps.LatLng(i.latlon.pickup_lat,i.latlon.pickup_lon),o=new google.maps.LatLng(i.latlon.dropoff_lat,i.latlon.dropoff_lon);new google.maps.Marker({position:e,map:r.map,icon:"img/markerA.png",labelContent:"A"}),new google.maps.Marker({position:o,map:r.map,icon:"img/markerB.png",labelContent:"B"});var g={origin:e,destination:o,travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.IMPERIAL};x.route(g,function(e,t){t==google.maps.DirectionsStatus.OK&&C.setDirections(e)}),C.setMap(r.map)}r.setDirections=function(e){C.setDirections(e),C.setMap(r.map)},i.onCreate({map:r.map}),i.$emit("mapset");var v={url:n.replace("/api/","/assets/")+"img/markers/transportation/town_car.png",scaledSize:new google.maps.Size(21,34)};i.setMarkers=function(e,n){r.map&&(M[e]?M[e].setPosition({lat:Number(n.lat),lng:Number(n.lng)}):(M[e]=new google.maps.Marker({position:{lat:Number(n.lat),lng:Number(n.lng)},map:r.map,icon:v}),n.clickable&&M[e].addListener("click",function(e){return function(){var n=t.getDispEmplByApikey(e);if(n){var o=new google.maps.InfoWindow({content:'<img style="vertical-align:middle;margin-right:5px" width="42" height="42" src="'+n.pic+'"><b>'+n.firstName+"</b>"});D[e]=o,o.open(r.map,M[e])}}}(e))),T[n.zone_id]?T[n.zone_id].indexOf(e)<0&&T[n.zone_id].push(e):T[n.zone_id]=[e])},i.centerGmap=i.centermap||{},i.removefromZone=function(e,t,n){for(var o in T){var i=T[o].indexOf(e);T[o].indexOf(e)>-1&&t&&(0==t.booked||t.zone_id!=o||n)&&T[o].splice(i,1)}},r.setMapMarkers=function(e){for(var t in e){var n={};n[t]=e[t],e[t].booked&&i.setMarkers(t,e[t]),M[t]&&(0==e[t].booked&&(google.maps.event.clearListeners(M[t],"click"),delete D[t],M[t].setMap(null),delete M[t]),i.removefromZone(t,e[t]))}for(var t in M)e[t]||(google.maps.event.clearListeners(M[t],"click"),delete D[t],M[t].setMap(null),delete M[t],i.removefromZone(t,e[t],!0));i.setCircleColors()},f=r.$on("zonemap:updated",function(){i.setCircleColors()}),r.setCircles=function(e){r.map&&(e.forEach(function(e){T[e.id]||(T[e.id]=[]);var t={lat:Number(e.lat),lng:Number(e.lon)},n=1609*Number(e.radius),o=1609*Number(e.zone_radius);S[e.id]?S[e.id].setOptions({center:t,radius:n,strokeColor:"#FF0000",fillColor:"#FF0000"}):(S[e.id]=new google.maps.Circle({strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.15,map:r.map,center:t,radius:n}),google.maps.event.addListener(S[e.id],"click",I)),n!=o?S[e.id+"inner"]?S[e.id+"inner"].setOptions({visible:T[e.id]&&T[e.id].length>0,center:t,radius:o,strokeColor:"#277134",fillColor:"#277134"}):(S[e.id+"inner"]=new google.maps.Circle({strokeColor:"#277134",strokeOpacity:.8,strokeWeight:2,fillColor:"#277134",fillOpacity:.05,visible:T[e.id]&&T[e.id].length>0,map:r.map,center:t,radius:o}),google.maps.event.addListener(S[e.id+"inner"],"click",I)):S[e.id+"inner"]&&(google.maps.event.clearListeners(S[e.id+"inner"],"click"),S[e.id+"inner"].setMap(null),delete S[e.id+"inner"])}),i.setCircleColors())},i.setCircleColors=function(){for(var e in S)T[e]&&T[e].length>0?(S[e].setOptions({strokeColor:"#4cd964",fillColor:"#4cd964"}),S[e+"inner"]&&S[e+"inner"].setOptions({fillOpacity:.15,visible:!0,strokeColor:"#277134",fillColor:"#277134"})):T[e]&&0==T[e].length&&(S[e]&&S[e].setOptions({strokeColor:"#FF0000",fillColor:"#FF0000"}),S[e+"inner"]&&S[e+"inner"].setOptions({visible:!1}))}}},O=function(){"complete"===document.readyState?o(function(){A()}):google.maps.event.addDomListener(window,"load",A)},V=!1;k=function(){google.maps.event.addListenerOnce(r.map,"idle",function(){V=!0,E()})},$(document).ready(function(){document.addEventListener("visibilitychange",function(){r.setMap()})}),r.centerMap=function(e,t){r.mapCentered=!0;var n=e||r.lat,o=t||r.lon,i=new google.maps.LatLng(n,o);r.map.panTo(i),r.map.setZoom(d.zoom)},r.setMap=function(){window.google&&(r.map||(null!=r.lat?O():e.ready(function(){t.setLatLon().then(function(){O()})})))},r.setMap();var P;r.setMapClass=function(e){r.map?(r.mapclass=null,r.mapclass=e,r.mapCentered=!0,document.querySelector("#gmap").className=e,r.setMap(),r.mapclass&&(document.querySelector("ion-view.pane").style.position="static",E()),o(function(){r.mapclass&&(document.querySelector("ion-view.pane").style.position="static")},500)):P=e},r.hasCircles=function(){return Object.keys(S).length>0},h=function(){for(var e in S)google.maps.event.clearListeners(S[e],"click"),google.maps.event.clearInstanceListeners(S[e]),S[e].setMap(null),delete S[e];for(var t in M)google.maps.event.clearListeners(M[t],"click"),google.maps.event.clearInstanceListeners(M[t]),M[t].setMap(null),delete M[t];S=null,S={},M=null,M={},T=null,T={},r.markers=null},r.resetMap=function(){r.map&&(h(),r.map.setOptions(d)),r.mapclass=null,document.querySelector("#gmap").className="",V=!1,C.setMap(null)},i.$on("$destroy",function(){p&&($(window).off("resize",resizer),p.setOptions(d)),f&&f(),g&&g(),v&&v(),v&&b(),h()})}}}]).directive("validPasswordC",function(){return{require:"ngModel",link:function(e,t,n,o){o.$parsers.unshift(function(t,n){var i=t!=e.myForm.password.$viewValue;o.$setValidity("noMatch",!i)})}}}).directive("seats",["$ionicModal","$rootScope","$timeout","$ionicScrollDelegate","EmployeeService",function(e,t,n,o,i){return{restrict:"E",require:"?ngModel",replace:!0,template:'<div><i ng-if="isIcon != \'false\'" class="col button button-icon icon ion-person-add" ng-click="openSeatsModal()"></i><div ng-if="isIcon == \'false\'" class="ion-person-add" ng-form ng-click="openSeatsModal()"><input disabled type="text" ng-model="ngModel"></div></div>',scope:{items:"=",people:"=",splitfare:"=",alertsplitfare:"=",text:"=?",value:"=?",item:"=?",itemsArr:"=?",itemType:"=",callback:"&",doneCallback:"&",ngModel:"=?",show:"=?"},link:function(n,i,r,a){n.isIcon=r.isIcon||"",n.openSeatsModal=function(){n.seatsModal?(n.seatsModal.show(),d()):e.fromTemplateUrl("modals/seats.html",{scope:n}).then(function(e){n.seatsModal=e,e.show(),d()})},n.seatsModel={setFunc:function(e){return e&&n.seats.forEach(function(t,n){t.checked=n==e-1}),angular.isDefined(e)?n.people=e:n.people}},n.splitEmails=[];var l=[];n.$on("$destroy",function(){n.seatsModal&&n.seatsModal.remove(),n.seatsModal=null,i.remove(),c&&c(),s&&s()}),n.seats=[{id:1,text:"1",checked:!0,icon:null},{id:2,text:"2",checked:!1,icon:null},{id:3,text:"3",checked:!1,icon:null},{id:4,text:"4",checked:!1,icon:null},{id:5,text:"5",checked:!1,icon:null}],n.shareFare={isChecked:!1};var s,c,d=function(){s=n.$watch("splitEmails.length",function(e,t,n){0==e&&(n.shareFare.isChecked=!1)}),c=n.$watch("shareFare.isChecked",function(e,n,o){e?e&&(t.disableSeatsCheck=o.splitEmails.every(function(e){return!e.valid})):t.disableSeatsCheck=!1})};n.addFare=function(e){n.splitEmails.push({id:n.splitEmails.length,email:"",valid:!0})},n.removeFare=function(e){var i=n.splitEmails.indexOf(e);i>-1&&n.splitEmails.splice(i,1),0==n.splitEmails.length?t.disableSeatsCheck=!1:t.disableSeatsCheck=n.splitEmails.every(function(e){return!e.valid}),o.scrollBy(0,-54,!0)},n.shareFareTapped=function(){0==n.splitEmails.length&&(n.splitEmails=[{id:0,email:"",valid:!0}]),o.resize(),n.shareFare.isChecked?o.scrollBottom(!0):o.scrollTop(!0)},t.disableSeatsCheck=!1,n.setValidEmail=function(e,o){n.splitEmails.forEach(function(t){t.id==e&&(t.valid=o)}),n.splitEmails.length>0&&(t.disableSeatsCheck=!o)},n.saveSeats=function(){l=[],n.splitEmails.length>0&&n.splitEmails.forEach(function(e){n.splitfare.push("splitFare[]="+e.email),l.push(e.email)}),n.seatsModal.hide(),n.alertsplitfare=l.join(",")}}}}]).directive("seatsButton",function(){return function(e,t,n){t.button(),e.$watch(n.seatsButtonDisabled,function(e){t.button("option","disabled",e)})}}).directive("splitFare",["$ionicScrollDelegate","baseUrl",function(e,t){return{restrict:"E",templateUrl:"modals/splitfare.html",scope:{index:"=",total:"=",notifyAdd:"&add",notifyRemove:"&remove",notifyValid:"&valid",ngModel:"="},controller:["$scope",function(n){n.baseUrl=t,n.showAddBtn=!1,n.emailInValid=!1,n.emailResult=function(e){n.emailInValid=!e},n.emailErrResult=function(e){n.emailError=!e,n.showAddBtn=e,n.notifyValid({isValid:e})},n.removeEmailField=function(){n.notifyRemove()},n.addEmailField=function(){n.notifyAdd(),e.resize(),e.scrollBottom(!0)},n.validating=function(e){n.isValidating=e}}]}}]).directive("customFooter",["$rootScope","$timeout","EmployeeService",function(e,t,n){return{restrict:"E",replace:!0,template:['<ion-footer-bar ng-hide="$root.keyboardopen" class="bar auto-height footer-container">','<div class="row driver-info">','<div class="dispatcherFtrRating col col-10">','<div ng-if="$root.loggedIn && $root.myCustomerRating && $root.show_rating" ng-click="$root.updateRating()">','<span ng-if="history.currentStateName() != \'app.quoteform\'" class="rating-number">{{$root.myDriverRating}}</span>','<span ng-if="history.currentStateName() == \'app.quoteform\'" class="rating-number">{{$root.myCustomerRating}}</span>','<div style="margin-top:13px" class="button-icon icon ion-star energized rating"></div>',"</div>","</div>",'<div class="dispatcherfooterbtn col col-55">','<div  ng-if="$root.loggedIn && $root.vehiclePermit.vehicle && $root.vehiclePermit.permit" ng-click="$root.showVehiclePermit()" class="footerVehiclePermit col col-30">','<div ng-if="$root.show_vehicle" style="padding: 0;" class="row"><i class="button-icon icon ion-model-s"></i><span>{{$root.vehiclePermit.vehicle}}</span></div>','<div ng-if="$root.show_permit" style="padding: 0;padding-top: 10px;" class="row"><i class="button-icon icon ion-card"></i><span>{{$root.vehiclePermit.permit}}</span></div>',"</div>","</div>","</div>","</ion-footer-bar>","</div>"].join(""),scope:{},link:function(t,n,o){t.history=e.history}}}]).directive("progressbar",["$rootScope","$timeout","$compile",function(e,t,n){return{restrict:"E",require:"?ngModel",replace:!0,template:"",scope:{callback:"&",max:"="},link:function(e,o,i){var r=o.find("timer")[0];e.countdown=e.$eval(i.countdown),e.max=e.$eval(i.max),e.callback=i.callback,e.defaultbgcolor=i.defaultbgcolor||"progress-defaultbgcolor",e.redbgcolor=i.redbgcolor||"progress-redbgcolor";var a='<div class="progress-wrapper"><div class=""><timer style="display:none" interval="1000" countdown=countdown finish-callback="countEnded()">{{mminutes}}:{{sseconds}}</timer></div><tek-progress-bar class="{{getColor()}}" bar-class="progress-bar-primary" ng-model="progressVal" manager="progressManager"></tek-progress-bar></div>';o.append(n(a)(e));var r=o.find("timer")[0];e.isRed=!1,e.getColor=function(){return e.isRed?e.redbgcolor:e.defaultbgcolor},e.countEnded=function(){e.callback=e.$eval(i.callback),"function"==typeof e.callback&&e.callback()},e.progressVal=0,e.checkRed=function(t){5>=t&&(e.isRed=!0)},e.checkRed(e.max-e.current);var l=e.$on("timer-tick",function(n,o){t(function(){e.checkRed(o.millis/1e3),e.current=e.max-o.millis/1e3,e.progressVal=Math.floor(e.current/e.max*100),e.timerText=r.outerText})});e.$on("$destroy",function(){l()})}}}]).directive("detectGestures",["$ionicGesture",function(e){return{restrict:"A",link:function(t,n,o){var i=e.on("tap",t.reportEvent,n),r=e.on("swiperight",t.swipeRightEvent,n),a=e.on("swipeleft",t.swipeLeftEvent,n);t.$on("$destroy",function(){e.off(i,"tap",t.reportEvent),e.off(r,"swiperight",t.swipeRightEvent),e.off(a,"swipeleft",t.swipeLeftEvent)})}}}]).directive("ionSelect",function(){"use strict";return{restrict:"EAC",scope:{label:"@",labelField:"@",provider:"=",ngModel:"=?",ngValue:"=?"},require:"?ngModel",transclude:!1,replace:!1,template:'<div class="selectContainer"><label class="item item-input item-stacked-label"><div class="item item-input-inset" style="border:none"><label class=""><i class="icon"></i><input style="background-color:transparent" readonly id="filtro" ng-click="open()" placeholder="{{label}}" type="input" ng-model="ngModel" ng-value="ngValue" ng-keydown="onKeyDown()"/></label></div></label><div class="optionList padding-left padding-right" ng-show="showHide"><ion-scroll><ul class="list"><li class="item" ng-click="selecionar(item)" ng-repeat="item in provider | filter:ngModel">{{item[labelField]}}</li></ul></ion-scroll></div></div>',link:function(e,t,n,o){e.ngValue=void 0!==e.ngValue?e.ngValue:"item",e.selecionar=function(t){o.$setViewValue(t),e.showHide=!1},t.bind("click",function(){}),e.open=function(){return e.ngModel="",e.showHide=!e.showHide},e.onKeyDown=function(){e.showHide=!0,e.ngModel||(e.showHide=!1)},e.$watch("ngModel",function(n){n&&t.find("input").val(n[e.labelField])})}}}).directive("contact",["$ionicPopover",function(e){"use strict";return{restrict:"EA",scope:{contactNumber:"@",cls:"@"},replace:!0,template:'<div ng-class="cls" ng-click="showPopover($event)" style="display:inline-block">{{contactNumber}}</div>',link:function(t,n,o){e.fromTemplateUrl("popovers/call-sms.html",{scope:t}).then(function(e){t.popover=e}),t.showPopover=function(e){t.popover.show(e)},t.$on("$destroy",function(){t.popover&&(t.popover.remove(),t.popover=null)})}}}]).directive("share",["$ionicPopover","$compile","$cordovaSocialSharing","$ionicPlatform","$translate",function(e,t,n,o,i){"use strict";return{restrict:"A",link:function(t,r,a){i("SHARE_WITH_FRIENDS").then(function(e){t.text=t.$eval(a.share)&&t.$eval(a.share).text||e}),t.subject="",r.addClass("shareicon"),r.on("click",function(o){ionic.Platform.isWebView()?n.share(t.text,t.subject,null,null).then(function(e){},function(e){}):t.popover?t.popover.show(o):e.fromTemplateUrl("popovers/share.html",{scope:t}).then(function(e){t.popover=e,t.popover.show(o)})}),t.canShareEmail=!1,ionic.Platform.isWebView()&&o.ready(function(){n.canShareViaEmail().then(function(e){t.canShareEmail=!0})});var l=function(e){var n=[];return n=[t.text]};t.sharemethod=function(e){alert(e),n["shareVia"+e].apply(this,l(e)).then(function(e){},function(e){})},t.$on("$destroy",function(){t.popover&&(t.popover.remove(),t.popover=null)})}}}]).directive("fancySelect",["$ionicModal","$rootScope","$timeout","EmployeeService","$filter",function(e,t,n,o,i){return{restrict:"E",templateUrl:"fancyselect/fancy-select.html",scope:{items:"=",text:"=?",value:"=?",item:"=?",itemsArr:"=?",itemsDetail:"=?",itemType:"=",callback:"&",doneCallback:"&",selectCallback:"&",show:"=?"},link:function(o,r,a){o.multiSelect="true"===a.multiSelect?!0:!1,o.allowEmpty="false"===a.allowEmpty?!1:!0,n(function(){o.heading=void 0!==a.heading?a.heading:!1,o.emptyText=void 0!==a.emptyText?a.emptyText:!1,o.headerText=a.headerText||""}),o.defaultText=o.text||"",o.noteText=a.noteText||"",o.noteImg=a.noteImg||"",o.noteImgClass=a.noteImgClass||"",o.noteImgWidth=a.noteImgWidth||"",o.noteImgHeight=a.noteImgHeight||"",o.onlyIcon=a.onlyIcon||"",o.icon=a.icon||"";var l=a.$observe("noteImg",function(e){""!=e&&(o.noteImg=a.noteImg,o.noteImgClass=a.noteImgClass,o.noteImgWidth=a.noteImgWidth,o.noteImgHeight=a.noteImgHeight,l())});e.fromTemplateUrl("fancyselect/fancy-select-items.html",{scope:o}).then(function(e){o.modal=e}),o.numDrivers=function(e){return Object.keys(o.itemsDetail[e]).length},o.validate=function(e){1==o.multiSelect&&(o.value="",o.text="",jQuery.each(o.itemss,function(e,t){t.checked&&(o.value=o.value+t.id+";",o.text=o.text+t.text+", ")}),o.value=o.value.substr(0,o.value.length-1),o.text=o.text.substr(0,o.text.length-2)),("undefined"==typeof o.value||""==o.value||null==o.value)&&(0==o.allowEmpty?(o.value=o.itemss[0].id,o.text=o.itemss[0].text,o.itemss[0].checked=!0):o.text=o.defaultText),o.items=o.itemss,o.itemsArr=o.itemsArray,o.itemType=o.itemTypes,o.item=o.itemm,o.hideItems()};var s=function(){o.showbtn=i("checkedItem")(o.itemss,"checked",null)};o.modalshown=!1,o.showbtn=!1,o.showItems=function(e){o.itemss=angular.copy(o.items),o.itemsArr&&(o.itemsArray=angular.copy(o.itemsArr)),o.itemType&&(o.itemTypes=o.itemType),o.item&&(o.itemm=o.item),e.preventDefault(),o.modal.show(),o.modalshown=!0,void 0==o.itemsArr&&void 0==a.itemsArr&&(o.itemsArray=[],1==o.itemss.length?o.itemSelected(o.itemss[0].text):o.itemsArray=o.itemss.filter(function(e){return e.checked})),void 0==o.itemType&&(o.itemTypes=""),1==o.multiSelect&&o.setItemCheckMark(!0)},t.showFancy=function(e){o.showItems(e)},o.show=function(e){o.showItems(e)},o.hideItems=function(){"function"==typeof o.callback&&n(function(){o.callback({selVal:o.value})}),o.modal.hide()},o.$on("$destroy",function(){o.modal&&o.modal.remove(),o.modal=null,r.remove(),c(),d()}),o.$on("$destroyfancy",function(){o.modal&&o.modal.remove()}),o.$on("modal.hidden",function(){d()});var c=o.$on("hide:fancy",function(){o.modal.hide()});o.$on("resetfancy",function(){o.items.forEach(function(e){e.checked=!1}),o.itemsArray&&(o.itemsArray.length=0)});var d=o.$watch("items",function(e,t){if(void 0!=e&&void 0!=t){o.itemss=o.items;var n={};e.forEach(function(e){n[e.id]=e});var i=t.filter(function(e){return!(e.id in n)});if(o.itemsArr&&o.itemsArray)for(var r in i){var a=o.itemsArray.indexOf(i[r].text);a>-1&&o.itemsArray.splice(a,1)}}});o.validateSingle=function(e){o.text=e.text,o.value=e.id,o.noteImg=e.icon,o.itemSelected(o.value),"function"==typeof o.callback,s(),o.validate()},o.validateMultiple=function(e){e.hasOwnProperty("disabled")&&e.disabled||(o.text=e.text,o.value=e.id,o.noteImg=e.icon,o.itemSelected(o.value),"function"==typeof o.callback,"function"==typeof o.selectCallback&&o.selectCallback({selVal:e}),s())},o.itemSelected=function(e){if(""==e)return o.itemsArray=[],o.itemm="",void(o.itemTypes="");if(o.itemsArray.indexOf(e)>-1){if(1==o.itemsArray.length)return o.setItemCheckMark(!1),e.split(",").length>1&&o.itemsArray.splice(o.itemsArray.indexOf(e),1),o.itemsArray=[],o.itemm="",void(o.itemTypes="");o.itemsArray.splice(o.itemsArray.indexOf(e),1)}else o.multiSelect||(o.setItemCheckMark(!1),o.itemsArray.length=0),e.indexOf(";")<0&&o.itemsArray.push(e);1==o.itemsArray.length?o.itemTypes=o.itemm=o.itemsArray[0]:(o.itemm=o.itemsArray.join(", "),o.itemTypes=o.itemsArray.join(",")),o.setItemCheckMark(!0)},o.setItemCheckMark=function(e){o.itemsArray;o.itemss.forEach(function(t){o.itemsArray.indexOf(t.id)>-1?t.checked=e?!0:!t.checked:t.checked=!1})}}}}]).directive("datePicker",["$ionicModal","$rootScope","$timeout","EmployeeService",function(e,t,n,o){return{restrict:"E",require:"?ngModel",templateUrl:"datepicker/fancy-select.html",scope:{callback:"&",doneCallback:"&",render:"&?",show:"=?",name:"=?",ngModel:"=?",tz:"=?"},link:function(o,i,r,a){n(function(){o.heading=void 0!==r.heading?r.heading:!1}),o.config=void 0!==r.config?r.config:{},o.required=void 0!==r.required?r.required:!1,o.headerText=r.headerText||"",o.name=r.name||void 0,o.isIcon=r.isIcon||"",o.tz=o.tz||t.tz,o.newUser={},o.tmp={},o.tmp.newDate=o.newUser.trackerDate,null!=a&&(a.$render=function(){void 0!=a.$modelValue?o.tmp.newDate=new Date(a.$modelValue):void 0!=o.newDate&&(o.tmp.newDate=new Date(o.newDate)),void 0==o.tmp.newDate&&(r.hasOwnProperty("renderafter")&&(o.tmp.newDate=""==r.renderafter?new Date:moment(r.renderafter,"MM-DD-YYYY").toDate()),r.hasOwnProperty("renderbefore")&&(o.tmp.newDate=""==r.renderbefore?new Date:moment(r.renderbefore,"MM-DD-YYYY").toDate()),r.hasOwnProperty("defaultexpiry")&&(o.tmp.newDate=new Date("12/31/"+(new Date).getFullYear())))}),o.beforeRender=function(e,t,n,i,a){if(r.hasOwnProperty("renderafter")||r.hasOwnProperty("renderbefore")){var l,s,c,d,u,m,p,f,g,v,h,w;r.hasOwnProperty("renderafter")&&(l=""==r.renderafter?new Date:moment(r.renderafter,"MM-DD-YYYY").toDate()),r.hasOwnProperty("renderbefore")&&(l=""==r.renderbefore?new Date:moment(r.renderbefore,"MM-DD-YYYY").toDate()),r.hasOwnProperty("reservation")&&(l=moment(l).add(o.$eval(r.reservation),"minutes").toDate()),r.hasOwnProperty("remoteReservation")&&(s=moment(new Date).add(o.$eval(r.remoteReservation),"minutes").toDate(),o.tz&&(s=moment(moment(s).tz(o.tz).format("YYYY-MM-DD HH:mm:ss")).toDate())),o.tz&&(l=moment(moment(l).tz(o.tz).format("YYYY-MM-DD HH:mm:ss")).toDate());var y=l.getFullYear(),b=l.getMonth(),k=moment(l).date(),$=l.getHours(),x=l.getMinutes(),C=6e4*l.getTimezoneOffset(),M=new Date(y,0,1).getTime(),D=new Date(y,b,1).getTime(),T=new Date(y,b,k).getTime(),S=new Date(y,b,k,$).getTime(),I=new Date(y,b,k,$,x).getTime();r.hasOwnProperty("remoteReservation")&&(c=s.getFullYear(),d=s.getMonth(),u=moment(s).date(),m=s.getHours(),p=s.getMinutes(),f=new Date(c,0,1).getTime(),g=new Date(c,d,1).getTime(),v=new Date(c,d,u).getTime(),h=new Date(c,d,u,m).getTime(),w=new Date(c,d,u,m,p).getTime());var E=!0;n.dateValue+C;"day"==e&&(i.display=i.display.split("-").reverse().join(", ")),t.forEach(function(n,o){var i=t[o].dateValue+C;"year"==e?(E=r.hasOwnProperty("renderafter")?i>=M:M>=i,E=r.hasOwnProperty("remoteReservation")?E&&f>=i:E):"month"==e?(E=r.hasOwnProperty("renderafter")?i>=D:D>=i,E=r.hasOwnProperty("remoteReservation")?E&&g>=i:E):"day"==e?(E=r.hasOwnProperty("renderafter")?i>=T:T>=i,E=r.hasOwnProperty("remoteReservation")?E&&v>=i:E):"hour"==e?(E=r.hasOwnProperty("renderafter")?i>=S:S>=i,E=r.hasOwnProperty("remoteReservation")?E&&h>=i:E):"minute"==e&&(E=r.hasOwnProperty("renderafter")?i>=I:I>=i,E=r.hasOwnProperty("remoteReservation")?E&&w>i:E),t[o].selectable=E})}},o.modalshown=!1;var l=function(){o.modal.show(),void 0!=o.newDate&&(o.newDate=void 0),angular.element(document.querySelector(".datetimepicker")).controller("ngModel").$render(o.tz),$(".modal-backdrop:has(.dtmodal)").css("z-index",30),o.modalshown=!0};e.fromTemplateUrl("datepicker/fancy-select-items.html",{scope:o}).then(function(e){o.modal=e}),o.showDatepicker=function(e){e.preventDefault(),l()},o.hideDatePicker=function(){o.modal.hide()},o.$on("$destroy",function(){o.modal&&o.modal.remove(),o.modal=null,i.remove(),c(),s()}),o.$on("$destroyfancy",function(){o.modal&&o.modal.remove()}),o.$on("modal.hidden",function(){});var s=o.$on("resetDtPicker",function(e,t){document.querySelector(".datetimepicker")&&(o.tmp.newDate=void 0)}),c=o.$on("hide:datepicker",function(){o.hideDatePicker()});o.onTimeSet=function(e,t){o.oldDate=t,o.newDate=e,void 0==t&&(o.oldDate=o.newDate)},o.save=function(){o.hideDatePicker(),"function"==typeof o.callback&&o.tmp.newDate&&o.callback({selDate:o.tmp.newDate,field:o.name})}}}}]).directive("mooFocusExpression",["$timeout",function(e){return{restrict:"A",link:{post:function(t,n,o){t.$watch(o.mooFocusExpression,function(i){o.mooFocusExpression&&t.$eval(o.mooFocusExpression)&&e(function(){n[0].focus()},100)})}}}}]).directive("accordion",["$rootScope","$timeout",function(e,t){return{restrict:"E",transclude:!0,scope:{items:"=",obj:"=",open:"=?",shown:"=",outershown:"=?"},template:'<ion-scroll ng-class="outershown ? scrollcls : \'\'" direction="y"><ion-list class="list-inset {{cls}}"><ion-item class="accordionClickItem" style="padding:0" ng-click="toggleInfo(obj)" ng-class="{active: isInfoShown(obj)}"><button ng-click="showActions(obj)" class="button button-clear button-dark accordion-heading">{{obj.heading}}</button><button style="float:right;" class="button button-clear button-positive" ng-class="isInfoShown(obj) ? \'ion-chevron-up\' : \'ion-chevron-down\'"></button></ion-item><ion-item class="item-accordion item-content item-text-wrap" ng-show="isInfoShown(obj)" ng-repeat="item in items" transcope></ion-item></ion-list></ion-scroll>',link:function(e,n,o){"noscroll"in o&&$(n).find("ion-list").unwrap().unwrap(),e.scrollcls=o.scrollcls||"";var i=o.$observe("scrollcls",function(t){e.scrollcls=t||""}),r=e.$watch(o.obj,function(t){void 0!=t&&(e.obj=t)});e.tapped=function(t){"A"!=t.target.tagName&&e.$emit("accorditemtapped",t)},e.cls=o.cls,e.toggleInfo=function(t){e.isInfoShown(t)?e.shownInfo=null:e.shownInfo=t},e.open=function(){var e=n[0].querySelector(".accordionClickItem");t(function(){angular.element(e).trigger("click")})},e.isInfoShown=function(t){return e.shown=t&&e.shownInfo===t,t&&e.shownInfo===t},e.$on("$destroy",function(){r(),i()})}}}]).directive("transcope",function(){return{link:function(e,t,n,o,i){if(!i)throw minErr("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",startingTag(t));var r=e.$new();i(r,function(e){t.empty(),t.append(e),t.on("$destroy",function(){r.$destroy()})})}}}).directive("bindHtmlCompile",["$compile",function(e){return{restrict:"A",link:function(t,n,o){t.$watch(function(){return t.$eval(o.bindHtmlCompile)},function(o){n.html(o),e(n.contents())(t)})}}}]).directive("backbutton",[function(){return{restrict:"E",replace:!0,scope:!1,template:'<button class="button icon button-clear"></button>',compile:function(e,t){var n=ionic.Platform.isAndroid()?"ion-android-arrow-back":"ion-ios-arrow-back";angular.element(e[0]).addClass(n)}}}]).directive("btnfunc",["$ionicGesture","$ionicScrollDelegate","$timeout",function(e,t,n){return{restrict:"A",scope:{func:"&btnfunc"},link:function(o,i,r){var a=function(){n(function(){o.func()}),n(function(){var e=$(i).parents().has(angular.element("form")).first(),n=$(e).find("form")[0];if(n&&$(n.querySelector(".ng-invalid"))[0]){var o=$(n.querySelector(".ng-invalid")).offset().top-84;t.scrollBy(0,o,!0)}})},l=e.on("swipe",a,i);o.$on("$destroy",function(){e.off(l,"swipe",a)})}}}]).directive("compareTo",function(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(e,t,n,o){o.$validators.compareTo=function(t){return t==e.otherModelValue},e.$watch("otherModelValue",function(){o.$validate()})}}}).directive("checkRequired",function(){return{require:"ngModel",restrict:"A",link:function(e,t,n,o){o.$validators.checkRequired=function(t,o){var i=t||o,r=e.$eval(n.ngTrueValue)||!0;return i&&r===i}}}}).directive("ionToggleCustomText",function(){var e=angular.element;return{restrict:"A",require:"ngModel",link:function(t,n,o,i){var r=o.ngTrueText||"on",a=o.ngFalseText||"off";if(o.ionToggleCustomText){var l=o.ionToggleCustomText.split(";");2===l.length&&(r=l[0]||r,a=l[1]||a)}var s=e('<div class="handle-text-custom handle-text-custom-true">'+r+"</div>"),c=e('<div class="handle-text-custom handle-text-custom-false">'+a+"</div>"),d=n.find("label");if(d.length){d.addClass("toggle-text-custom");var u,m,p=d.find("div");if(angular.forEach(p,function(t){var n=e(t);n.hasClass("handle")?m=n:n.hasClass("track")&&(u=n)}),m&&u){m.append(s),m.append(c);var f=s[0].offsetWidth,g=c[0].offsetWidth;s.css("left","-"+(f+6)+"px"),t.$watch(function(){return i.$modelValue},function(e){e==o.ngTrueValue.replace(/\'/g,"")?m.css("left",f+12+9+"px"):m.css("left","6px")});var v=Math.max(f,g);u.css("width",v+43+"px")}}}}}).directive("ionToggleText",["$compile","$rootScope",function(e,t){var n=angular.element;return{restrict:"A",scope:{},link:function(e,o,i){var r=i.ngOnValue||"on",a=i.ngOffValue||"",l=i.$observe("ngOnValue",function(t){r=t,e.build()}),s=i.$observe("ngWithinZone",function(t){e.toggleClass(e.$eval(t))}),c=i.$observe("booked",function(t){e.build(),i.ngWithinZone||e.toggleClass(e.$eval(t))});e.$destroy=function(){l(),s(),c()},e.toggleClass=function(e){var t=o.find("label");e?t.removeClass("toggle-outsidezone").addClass("toggle-withinzone"):t.removeClass("toggle-withinzone").addClass("toggle-outsidezone")},e.build=function(){if(i.ionToggleText){var e=i.ionToggleText.split(";");2===e.length&&(r=e[0]||r,a=e[1]||a)}var l=n('<div class="handle-text handle-text-true">'+r+"</div>"),s=n('<div class="handle-text handle-text-false">'+a+"</div>"),c=o.find("label");if(c.length){c.addClass("toggle-text");var d,u,m=c.find("div");if(angular.forEach(m,function(e){
var t=n(e);t.hasClass("handle")?u=t:t.hasClass("track")&&(d=t)}),u&&d){o[0].querySelector(".handle-text")&&(u.html(""),u.html("")),u.append(l),u.append(s);var p=l[0].offsetWidth,f=s[0].offsetWidth;p=Math.max(p,26),f=Math.max(f,26);var g=l.textWidth()<29?-7:0;l.css("left","-"+(p+7+g)+"px"),s.css("left",f+14+"px");var v=Math.max(p,f);d.css("width",v+52+"px"),"true"==i.booked?(u.css("left",p+10+14+"px"),angular.element(o[0].querySelector(".handle-text-false")).css("color","transparent"),angular.element(o[0].querySelector(".handle-text-true")).css("color","white")):(u.css("left","7px"),angular.element(o[0].querySelector(".handle-text-true")).css("color","transparent"),angular.element(o[0].querySelector(".handle-text-false")).css("color","black"),d.css("width","77px")),i.booked&&i.driver&&!t.show_QP&&angular.element(o[0].querySelector(".handle-text-true")).css("display","none")}}},e.build()}}}]).directive("vin",["$q","$timeout","$http","$rootScope",function(e,t,n,o){return{restrict:"A",require:"ngModel",scope:{onDone:"&"},link:function(t,i,r,a){a.$asyncValidators.vin=function(i){var r=e.defer();return o.$broadcast("loading:show"),n.get("https://api.edmunds.com/api/vehicle/v2/vins/"+i+"?fmt=json&api_key=9mjx9dzqsq8gzjcehjmcnyuq").success(function(e){t.onDone({res:e}),r.resolve()}).error(function(e){t.onDone({res:e}),r.resolve()}),r.promise}}}}]).directive("clearField",["$compile",function(e){return{restrict:"A",scope:!0,require:"^form",template:"<ng-transclude></ng-transclude>",transclude:!0,link:function(t,n,o,i,r){var a=o.clrClass||"rt5",l=n.find("input"),s=l[0].attributes["ng-model"].value,c=(t.$parent.$new(),angular.element('<span ng-if="'+s+" !== '' && "+s+' != undefined" ng-click="clearSearch()" class="button button-clear ft25 ion-ios-close '+a+'"></span>'));c.insertAfter(n),e(c)(t),t.clearSearch=function(){var e=l[0].name;i[e].$setViewValue(""),angular.element(l).controller("ngModel").$render()}}}}]).directive("tooltip",["$translate",function(e){return{restrict:"C",link:function(t,n,o){e(["BUTTON_SWIPTE_TOOLTIP","FILL_FORM"]).then(function(e){var t=$(n);t.attr("title",o.title||e.BUTTON_SWIPTE_TOOLTIP);t.tooltipster({animation:o.animation||"fade",trigger:"click",position:"top",positionTracker:!0,maxWidth:500,timer:1e3,contentAsHTML:!0,functionInit:function(e,t){},functionBefore:function(n,o){t.hasClass("disabled")?(n.tooltipster("content",n.attr("disable-title")||e.FILL_FORM),o()):(n.tooltipster("content",n.attr("title")||e.BUTTON_SWIPTE_TOOLTIP),o())}})})}}}]).directive("ionSearch",function(){return{restrict:"E",replace:!0,scope:{getData:"&source",model:"=?",search:"=?filter"},link:function(e,t,n){n.minLength=n.minLength||0,e.placeholder=n.placeholder||"",e.search={value:""},n["class"]&&t.addClass(n["class"]),n.source&&e.$watch("search.value",function(t,o){t.length>n.minLength?e.getData({str:t}).then(function(t){e.model=t}):e.model=[]}),e.clearSearch=function(){e.search.value=""}},template:'<div class="item-input-wrapper"><i class="icon ion-android-search"></i><input type="search" placeholder="{{placeholder}}" ng-model="search.value"><i ng-if="search.value.length > 0" ng-click="clearSearch()" class="icon ion-close"></i></div>'}}).filter("checkedItem",function(){return function(e,t,n){var o=e.some(function(o,i){return(e.length-1!=i||"object"==typeof n)&&o[t]||n&&e.length-1==i&&o[t]});return o}}).filter("nl2br",["$filter",function(e){return function(e){return e?e.replace(/\n\r?/g,"<br />"):e}}]).filter("ftToMiles",function(){return function(e){return e&&e.indexOf("ft")>-1?parseFloat(189394e-9*parseInt(e,10)).toFixed(1)+" mi":e}});